\pagebreak
\pagenumbering{arabic}
\chapter{Introduction}

Since neurons are driven by electric currents, altering the surrounding electrical conditions can modify their behavior. Both electrically and magnetically induced stimulation has been in use for many years, with the latter being studied a couple of years earlier. Different physics underlie each method with the end effects being similar.

\begin{wrapfigure}{l}{0.40\textwidth}
    \centering
    \includegraphics[width = 0.3\textwidth]{assets/images/cortical_layers.pdf}
    \caption{Cellular structure of the neocortex. (Purves et al.\cite{Purves2012}, Figure 27.1(B) p.628)}
    \label{fig:cortical_layers}
\end{wrapfigure}

Due to the layered structure (\autoref{fig:cortical_layers}) of the neocortex, \gls{TMS} induced electric fields affect mostly interneurons and collaterals of the tangentially aligned pyramidal cells, whereas the overall electric field induced by electrical stimulation is normal to the cortical surface thus affecting mostly \textit{layer V} pyramidal neurons as most of them are perpendicular to the cortex. The edn result is that \gls{TMS} induced fields have short penetration depth, while \gls{tES} induced fields can reach deep in the brain, at a cost of spatial resolution. As such \gls{tES} is mostly used to try and reach deep targets.

\gls{DBS} and especially the non-invasive methods to achieve it is an emerging need, since most of the functionality of key brain components lies deep in the brain. Although there are successful invasive method that can alleviate Parkinson's symptoms, non-invasive methods can offer greater scalability and less risk for the patient. The challenge posed by the non-invasive methods though is the lack of spatial resolution and pin-point targeting of the desired area, usually a small enough area in the order of tens of millimeter (e.g. pituitary gland \cite{Yadav2017_pituitary}).

At 2017 a new method first brought to light by Nir Grossman and his team \cite{Grossman2017} which seemingly revolutionizes the way non-invasive \gls{DBS} is accomplished, by accommodating clever tricks \textit{"hacking"} the physics of neurons. The \paper{Grossman}{Grossman2017} method uses a pair of electrodes, injected with a high frequency alternating current, which envelope oscillates at the desired frequency, set by the difference between the frequency difference between the electrode pairs. The great advantage as a result is the ability to reach deep targets and stimulate only the areas of interest, without stimulating the surrounding areas or the whole brain.

The Grossman's method shows promise in the future of \gls{DBS} and it is studied in this work to assess the potential use in humans, since in the original work \cite{Grossman2017} only spherical models and simple phantom models were used, in conjunction with successful test runs in murine subjects. Further study on realistic human brain models will aid in the understanding of the \gls{tTIS} specifics and testing on healthy individuals will consolidate the method's effectiveness.

Lastly, this work's goal is to aid in creating optimized and personalized treatment planning for humans, through detailed computer simulations. The greatest benefit to science and the society comes from open knowledge sharing and abiding to this belief this work's code, designs, texts and any material originally produced is publicly available on the GitLab repository \cite{thesis_repo}.

\section{Methods of Electrical Stimulation}

To better understand the major advantages of the \gls{tTIS} method, the different methods for achieving electrical stimulation shall be presented. An overview of the two main methods is presented in this section, as these are the most commonly used ones and also they are the basis for almost all the other electrical stimulation method variations.

\subsection{Transcranial Direct Current Stimulation \textit{(tDCS)}}

\gls{tDCS} delivers constant current via electrodes placed on the head, targeting to stimulate the cortical areas. There are numerous studies showing promising results in depression treatment \cite{Moffa2020,Brunoni2016} and \gls{tDCS} is increasingly used in such cases \cite{Nitsche2008}.

Although \gls{tDCS} is good for an overall cortical stimulation, the lack of focality is one of the key issues. As it can be seen in \autoref{fig:tdcs_pattern} the electric current flows though a particularly large area, potentially affecting unwanted areas.

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.75\textwidth]{assets/images/tdcs_pattern.png}
    \caption{\gls{tDCS} pattern showcase with \draft{electrodes} based on the 10-20 system.}
    \label{fig:tdcs_pattern}
\end{figure}

Furthermore, achieving neural firing synchronization is impossible through \gls{tDCS}, since achieving this kind of effect requires alternating current. The method that can have such an impact is \gls{tACS}.

\subsection{Transcranial Alternating Current Stimulation \textit{(tACS)}}

In many aspects \gls{tACS} and \gls{tDCS} are the same. As mentioned before, the key component where \gls{tACS} differs is the neural firing synchronization. Same as \gls{tDCS}, this method also lacks focality and there is one more issue in the game.

\gls{tACS} requires using low frequency currents, at the tens of Hz range, since at those frequencies the neurons are firing the action potentials. The problem arising here is the stimulation of large area, synchronized at the stimulating current frequency. Such a synchronization can have adverse effects, i.e. stimulating and synchronizing unwanted areas.

Stimulating with higher frequency currents, renders the method useless since the neuronal membrane is either not able to follow the oscillation or the frequency is too high for the desired synchronization. This problem is solved by the \gls{tTIS} method, studied in this work.

\subsection{Transcranial Temporal Interference Stimulation \textit{(tTIS)}}

\gls{tTIS} is essentially \gls{tACS} with a small, but important modification. Taking advantage of the superposition principle of the electric field, utilizing the interference patterns is key for this method. The current flowing through each electrode pair has a high enough frequency that does not modulate any neurons, as opposed to \gls{tACS} where the frequency shall be in the target modulation range. The modulator here is the envelope (\autoref{fig:modulation_showcase}) of the temporal interference of the two electric fields, since the envelope modulates at the difference of the two frequencies from the electrode.

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.95\textwidth]{assets/images/modulation_envelope.pdf}
    \caption{Wave superposition pattern with equal amplitude waves}
    \label{fig:modulation_showcase}
\end{figure}

This method was tested by \paper{Grossman}{Grossman2017} on murine brains and the results were spot on with the respective simulation. Targeted neuro-modulation was achieved, with a much better focality and depth than the traditional methods. Although this method works well on murine brains, it poses a great challenge for the human models as the geometry and the volume changes dramatically. A sample image from this work can be seen on \autoref{fig:ttis_pattern}, where the focality and depth achieved by the Grossman method in comparison with \autoref{fig:tdcs_pattern} is clearly visible.

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.75\textwidth]{assets/images/ttis_pattern.png}
    \caption{Electric field pattern of the \gls{tTIS} method using \draft{electrodes} as the base frequency electrodes and \draft{electrodes} as the second frequency electrodes. The base frequency is $f = 1\; kHz$ and $\Delta f=40\; kHz$.}
    \label{fig:ttis_pattern}
\end{figure}

This methods shows real promise and it is yet to be discovered by follow-up works and real experiments on human subjects in the clinical setting, potentially aiding in the treatment of some diseases.

\section{Theoretical Background}

To better understand the physics behind the simulations, a brief explanation regarding the conduction within the media is presented in \autoref{sec:e_ohmic_qs}, followed by an analysis regarding the \gls{tTIS} hypothesis based on Grossman et al.\cite{Grossman2017} work.

\subsection{Electric Field Ohmic Quasi-static Approximation}
\label{sec:e_ohmic_qs}

Generally Maxwell's equations for electromagnetic wave propagation in a medium are as follows:
% Maxwells equations
\begin{center}
\begin{minipage}{.35\linewidth}
    \begin{equation}
        \nabla\cdot\vec{E}=\dfrac{\rho}{\epsilon}
    \end{equation}
\end{minipage}
\begin{minipage}{.35\linewidth}
    \begin{equation}
        \nabla\cdot\vec{B} = 0
    \end{equation}
\end{minipage}\break
\begin{minipage}{.35\linewidth}
    \begin{equation}
        \label{eq:maxwell_curl_e}
        \nabla\times\vec{E}=-\dfrac{\partial\vec{B}}{\partial t}
    \end{equation}
\end{minipage}
\begin{minipage}{.35\linewidth}
    \begin{equation}
        \nabla\times\vec{B} = \mu\Bigg(\vec{J} + \epsilon\dfrac{\partial\vec{E}}{\partial t}\Bigg)
    \end{equation}
\end{minipage}
\end{center}

\noindent The problem in question, finding the electrical field distribution in a volume using low frequencies, can be approached by simplifying the general form of Maxwell's equations and deriving the Quasi-static approximation format. The first step is to define the assumptions taken in order for such an approach to be valid.

For the frequencies used in the studied problem, in \si{kHz} range, the displacement current can be neglected making the Ohmic currents dominate. Also, since the magnetic field is not time variant, based on \autoref{eq:maxwell_curl_e} we can write:
\begin{equation}
    \label{eq:curl_zero_e_field}
    \nabla\times\vec{E} = \vec{0}
\end{equation}
and as we know when a field is irrotational then it can be calculated from a scalar potential ($\phi$) as seen below:
\begin{equation}
    \label{eq:e_field_from_potential}
    \boxed{\vec{E} = -\nabla\phi}
\end{equation}

\noindent Moreover, since the sum of currents entering and exiting the volume is zero \textit{(Kirchhoff's second law)} we can denote:
\begin{equation}
    \nabla\cdot\vec{J} = 0
\end{equation}
where here $\vec{J}$ is the ohmic current seen below as it is assumed that there are no current sources in the volume:
\begin{equation}
    \label{eq:sigma_e_0}
    \vec{J} = \sigma\vec{E}\Rightarrow\boxed{\nabla\cdot\big(\sigma\vec{E}\big) = 0}
\end{equation}
with $\sigma$ being the electrical conductivity of each medium. Finally, based on \cref{eq:e_field_from_potential,eq:sigma_e_0} the final relationship describing the problem can be derived:
\begin{equation}
    \label{eq:laplace_e}
    \boxed{\nabla\cdot(\sigma\nabla\phi) = 0}
\end{equation}

\autoref{eq:laplace_e} describes the problem of conduction, using bulk conductors, but it is worth noting that the equation is only valid in the frequency domain where the displacement current effects are negligible and only when there is no charge generated \textit{(charge is conserved)}. Furthermore, care shall be taken with the conductivity values, since depending on the material it may be dependant on the frequency used for the stimulation.

\pagebreak
\subsection{Temporal Interference}
The utilization of \gls{tTIS} to achieve targeted \gls{DBS} was first introduced by Grossman et al.\cite{Grossman2017}. This technique takes advantage of the spatial electromagnetic wave interference, using frequencies at the \si{kHz} range, having almost no effect on neurons since it is known that they do not respond to higher than 1\si{kHz} frequencies \cite{Hutcheon2000}.
\\\vspace{1pt}

\begin{wrapfigure}{r}{0.48\textwidth}
    \vspace{-10pt}
    \centering
    \includegraphics[width = 0.44\textwidth]{assets/images/brain_figure_ttis.pdf}
    \caption[Depiction of the \gls{tTIS} pattern and the vector direction of the electric field. The purple area is the \gls{ROI} where interference happens.]{Depiction of the \gls{tTIS} pattern and the vector direction of the electric field. The purple area is the \gls{ROI} where interference happens. Image by \href{https://pixabay.com/users/openclipart-vectors-30363/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=150935}{OpenClipart-Vectors} from \href{https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=150935}{Pixabay}}
    \label{fig:brain_elec_demo}
\end{wrapfigure}

Using two pairs of electrodes (\autoref{fig:brain_elec_demo}), with each pair having a slightly different frequency, an interference pattern can be generated in the conducting medium oscillating at the difference of the two frequencies. Depending on the nature of the medium the pattern can vary and as illustrated in Grossman et al.\cite{Grossman2017} when a uniform medium is used, it is simple and easy to calculate.

Since the modulation happens in the 3D space, there will be different patterns in the $x$, $y$ and $z$ directions. According to Grossman et al.\cite[page 20]{Grossman2017}, at any location $\vec{r} = (x,y,z)$ the envelope amplitude of the \gls{AM} of the electric field produced by the temporal interference, it is calculated as:
\begin{equation}
    \label{eq:directional_amplitude}
    \vec{E}(\vec{n},\vec{r}) = \Big|\big|(\vec{E_1} + \vec{E_2})\cdot\vec{n}\big| - \big|(\vec{E_1} - \vec{E_2})\cdot\vec{n}\big|\Big|
\end{equation}
where $\vec{E_1} = \vec{E_1}(\vec{r})$, $\vec{E_2} = \vec{E_2}(\vec{r})$ are the electric fields coming from the two electrodes and $\vec{n} = \vec{n}(\vec{r})$ is the unit vector at the direction of interest.
\\\vspace{1pt}

What is of interest is the maximum amplitude of modulation at a specific location since the modulation will vary with time between zero and maximum. To calculate that amplitude across all directions, the analysis on Grossman et al.\cite[page 20]{Grossman2017} can be better supported by the analysis done on Rampersad et al.\cite[section 2.5]{Rampersad2019} and based on the two aforementioned publications, a complete description will be given here. The formula to calculate the maximum modulation amplitude, along all directions at a specific location, $\vec{r} = (x,y,z)$, is:
\begin{equation}
    \label{eq:max_mod_amplitude}
    \vec{E}_{AM}^{max}(\vec{r}) = \begin{cases}
        2\big|\vec{E_2}\big| & \text{if}\; \big|\vec{E_2}\big| < \big|\vec{E_1}\big|\cos\alpha \\
        &\\
      2\dfrac{\Big|\big|\vec{E_2}\big|\times\big(\vec{E_1} - \vec{E_2}\big)\Big|}{\big|\vec{E_1} - \vec{E_2}\big|} & \text{otherwise}
    \end{cases}
\end{equation}
where $\alpha$ is the angle between $\vec{E_1}$ and $\vec{E_2}$, while \autoref{eq:max_mod_amplitude} holds true only if $\alpha < 90\si{\degree}$. Whenever $\alpha \geq 90\si{\degree}$, the sign of one of the two fields can be flipped \textit{(it must be done is a consistent fashion)} since reaching peak field strength at different time points across different areas, is what makes the $< 90\si{\degree}$ rule to be violated. Such a change is possible considering that \autoref{eq:max_mod_amplitude} calculates the maximum effect over one oscillation, so the overall effect is the one that we care. The calculation of $\vec{E}_{AM}^{max}$ can be seen in \autoref{alg:max_modulation_amplitude} at \autoref{appndx:algorithms}.
